# ==========================================
# üçé MAC / RIDER / VS CODE API SUITE
# ==========================================

# Configuration Variables
@hostname = localhost
@port = 5083
@host = http://{{hostname}}:{{port}}
@contentType = application/json

# üé≤ Generate Random User for Session
@username = player_{{$randomInt}}
@password = Password123!

# ==========================================
# üè• HEALTH & STATUS
# ==========================================

### Health Check
GET {{host}}/health

###

# ==========================================
# üîê AUTHENTICATION
# ==========================================

### Register New User
POST {{host}}/api/v1/auth/register
Content-Type: {{contentType}}

{
  "username": "{{username}}",
  "email": "{{username}}@game.com",
  "password": "{{password}}"
}

###

### Login (Saves Token Automatically)
# @name loginRequest
POST {{host}}/api/v1/auth/login
Content-Type: {{contentType}}

{
  "username": "{{username}}",
  "password": "{{password}}"
}

> {%
    // üíæ Auto-save authentication token
    client.global.set("auth_token", response.body.token);
    client.log("Token saved: " + response.body.token);
%}

###

### Change Password
POST {{host}}/api/v1/auth/change-password
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

{
  "currentPassword": "{{password}}",
  "newPassword": "New{{password}}",
  "confirmNewPassword": "New{{password}}"
}

###

### Logout
POST {{host}}/api/v1/auth/logout
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

###

# ==========================================
# üõ°Ô∏è SECURITY VALIDATION TESTS
# ==========================================

### Test: Weak Password (Should Fail Validation)
POST {{host}}/api/v1/auth/register
Content-Type: {{contentType}}

{
  "username": "weak_user",
  "email": "weak@test.com",
  "password": "123"
}

###

### Test: Invalid Token (Should Return 401)
POST {{host}}/api/v1/auth/change-password
Authorization: Bearer invalid_token_example
Content-Type: {{contentType}}

{
  "currentPassword": "123",
  "newPassword": "123",
  "confirmNewPassword": "123"
}

###