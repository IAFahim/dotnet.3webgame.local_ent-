# ==========================================
# ğŸ MAC / RIDER / VS CODE API SUITE
# ==========================================

@hostname = localhost
@port = 5083
@host = http://{{hostname}}:{{port}}
@contentType = application/json

# ğŸ² Generate random user for this session
@username = player_{{$randomInt}}
@password = Password123!

### ğŸŸ¢ 1. HEALTH CHECK
GET {{host}}/health

###

### ğŸ“ 2. REGISTER
POST {{host}}/api/auth/register
Content-Type: {{contentType}}

{
  "username": "{{username}}",
  "email": "{{username}}@game.com",
  "password": "{{password}}"
}

###

### ğŸ”‘ 3. LOGIN (Run this to save Token!)
# @name loginRequest
POST {{host}}/api/auth/login
Content-Type: {{contentType}}

{
  "username": "{{username}}",
  "password": "{{password}}"
}

> {%
    // ğŸ’¾ THIS SCRIPT SAVES THE TOKEN AUTOMATICALLY
    client.global.set("auth_token", response.body.token);
    client.log("Token saved: " + response.body.token);
%}

###

### ğŸ’° 4. GET COINS (Uses Saved Token)
GET {{host}}/api/auth/coins
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

###

### ğŸ‘¤ 5. GET PROFILE
GET {{host}}/api/auth/profile
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

###

### ğŸ” 6. CHANGE PASSWORD
POST {{host}}/api/auth/change-password
Authorization: Bearer {{auth_token}}
Content-Type: {{contentType}}

{
  "currentPassword": "{{password}}",
  "newPassword": "New{{password}}",
  "confirmNewPassword": "New{{password}}"
}

###

### ğŸ›‘ 7. SECURITY CHECK: Weak Password
POST {{host}}/api/auth/register
Content-Type: {{contentType}}

{
  "username": "weak_user",
  "email": "weak@test.com",
  "password": "123"
}

###

### â›” 8. SECURITY CHECK: Bad Token
GET {{host}}/api/auth/coins
Authorization: Bearer invalid_token_example